import{j as e,T as u,L as N,r as t,A as f,H as y,M as j,u as L,a as v,B as p,b as w,P as S,c as x,d as E}from"./index.D_sR2hE4.js";function b({heading:o,paragraph:i,linkName:s,linkUrl:r="#"}){return e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"w-20 h-20 mx-auto logo"}),e.jsx(u,{variant:"h4",className:"mt-6 text-center text-3xl font-extrabold",children:o}),e.jsxs(u,{className:"text-center text-sm mt-5",children:[i,e.jsx(N,{to:r,className:"font-medium ml-2",style:{color:"#5f2eea"},children:s})]})]})}function A(){const{login:o}=t.useContext(f),{handleAllErrors:i}=t.useContext(y),{mapKeys:s}=t.useContext(j),[r,n]=t.useState(),m=L({flow:"auth-code",onSuccess:d=>n(d),onError:()=>i(s("Login Failed"))}),a=async()=>{try{(await w.post("http://localhost:7000/auth/google/login",r,{withCredentials:!0})).data.authenticated&&(o(),l())}catch{i(s("Login Failed"))}};t.useEffect(()=>{r&&a()},[r]);const c=v(),l=()=>c("/home");return e.jsx("div",{className:"flex flex-col items-center justify-center space-y-2",children:e.jsxs(p,{variant:"outlined",className:"gap-3",sx:{textTransform:"none"},onClick:()=>m(),children:[e.jsx(u,{children:s("Log in with Google")}),e.jsx("img",{draggable:"false",className:"w-6 h-6",src:"https://www.svgrepo.com/show/475656/google-color.svg",loading:"lazy",alt:"google logo"})]})})}function _(){const{login:o}=t.useContext(f),{handleAllErrors:i}=t.useContext(y),{mapKeys:s}=t.useContext(j),[r,n]=t.useState(),m=L({flow:"auth-code",onSuccess:d=>n(d),onError:()=>i(s("Login Failed"))}),a=async()=>{try{(await w.post("http://localhost:7000/auth/google/signup",r,{withCredentials:!0})).data.authenticated&&(o(),l())}catch{i(s("User already exists"))}};t.useEffect(()=>{r&&a()},[r]);const c=v(),l=()=>c("/setup");return e.jsx("div",{className:"flex flex-col items-center justify-center space-y-2",children:e.jsxs(p,{variant:"outlined",className:"gap-2",sx:{textTransform:"none"},onClick:()=>m(),children:[e.jsx(u,{children:s("Sign up with Google")}),e.jsx("img",{draggable:"false",className:"w-6 h-6",src:"https://www.svgrepo.com/show/475656/google-color.svg",loading:"lazy",alt:"google logo"})]})})}function k(){const{login:o}=t.useContext(f),{handleAllErrors:i}=t.useContext(y),{mapKeys:s}=t.useContext(j),r=v(),[n,m]=t.useState({email_address:"",password:""}),[a,c]=t.useState({email_address:"",password:"",form:""}),l=h=>{m({...n,[h.target.name]:h.target.value})},d=async h=>{h.preventDefault();try{(await w.post("http://localhost:7000/auth/login",n,{withCredentials:!0})).data.access_token&&(o(),r("/home"))}catch(g){g.response&&g.response.data.detail?c({...a,form:g.response.data.detail}):i(s("Login Failed"))}};return e.jsx(S,{elevation:3,className:"p-4",children:e.jsxs("form",{onSubmit:d,noValidate:!0,children:[e.jsx(u,{variant:"h5",children:s("Login")}),e.jsx(x,{name:"email_address",label:s("Email Address"),value:n.email_address,onChange:l,fullWidth:!0,margin:"normal",error:!!a.email_address,helperText:a.email_address}),e.jsx(x,{name:"password",label:s("Password"),type:"password",value:n.password,onChange:l,fullWidth:!0,margin:"normal",error:!!a.password,helperText:a.password}),e.jsxs("a",{href:"mailto:gorillabrainai@gmail.com",className:"items-center justify-center flex pb-2 gap-3",children:[e.jsx(u,{children:s("Forgot your password?")}),e.jsx(p,{variant:"outlined",color:"primary",sx:{textTransform:"none"},children:s("Email Support")})]}),a.form&&e.jsx(u,{color:"error",children:a.form}),e.jsx(p,{type:"submit",variant:n.password&&n.email_address?"contained":"outlined",color:"primary",fullWidth:!0,children:s("Login")})]})})}function T(){const{login:o}=t.useContext(f),{handleAllErrors:i}=t.useContext(y),{mapKeys:s}=t.useContext(j),r=v(),[n,m]=t.useState({username:"",email_address:"",password:""}),[a,c]=t.useState({}),l=h=>{m({...n,[h.target.name]:h.target.value})},d=async h=>{h.preventDefault();try{w.post("http://localhost:7000/auth/register",n,{withCredentials:!0}).then(()=>{o(),r("/home")})}catch(g){g.response&&g.response.data.detail?c({...a,form:g.response.data.detail}):i(s("Signup Failed"))}};return e.jsx(S,{elevation:3,className:"p-4",children:e.jsxs("form",{onSubmit:d,noValidate:!0,children:[e.jsx(u,{variant:"h5",children:s("Sign Up")}),e.jsx(x,{name:"username",label:s("Username"),value:n.username,onChange:l,fullWidth:!0,margin:"normal",error:!!a.username,helperText:a.username}),e.jsx(x,{name:"email_address",label:s("Email Address"),value:n.email_address,onChange:l,fullWidth:!0,margin:"normal",error:!!a.email_address,helperText:a.email_address}),e.jsx(x,{name:"password",label:s("Password"),type:"password",value:n.password,onChange:l,fullWidth:!0,margin:"normal",error:!!a.password,helperText:a.password}),a.form&&e.jsx(u,{color:"error",children:a.form}),e.jsx(p,{type:"submit",variant:n.username&&n.email_address&&n.password?"contained":"outlined",color:"primary",fullWidth:!0,children:s("Sign Up")})]})})}let C;function F(){const{mapKeys:o}=t.useContext(j),i=E(),[s,r]=t.useState(!1);t.useEffect(()=>{window.addEventListener("beforeinstallprompt",l=>{l.preventDefault(),C=l,r(!0)}),window.addEventListener("appinstalled",()=>{console.log("INSTALL: Success")})},[]);const n=()=>{r(!1),C.prompt(),C.userChoice.then(l=>{l.outcome==="accepted"?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")})},{hasAccess:m}=t.useContext(f),a=v(),c=i.pathname!=="/signup";return t.useEffect(()=>{m&&c&&a("/home")},[m,c]),e.jsxs("div",{className:"min-h-full h-[100vh] flex items-center bg-custom justify-center px-4 sm:px-0 lg:px-8 ",children:[e.jsx(S,{elevation:3,className:"max-w-md w-full bright-div space-y-1  p-4 rounded-lg  max-h-[95vh] overflow-y-auto ",children:c?e.jsxs(e.Fragment,{children:[e.jsx(b,{heading:o("Login to your account"),paragraph:o("Don't have an account yet?"),linkName:"Signup",linkUrl:"/signup"}),"            ",e.jsx(A,{}),e.jsx(u,{className:"text-center text-sm mt-5",children:o("or")}),e.jsx(k,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{heading:o("Signup to create an account"),paragraph:o("Already have an account?"),linkName:"Login",linkUrl:"/login"}),s&&e.jsx("div",{className:"flex justify-center",children:e.jsx(p,{onClick:n,variant:"contained",color:"primary",children:o("Click here to install Phaero")})}),"            ",e.jsx(_,{}),e.jsx(u,{className:"text-center text-sm mt-5",children:o("or")}),e.jsx(T,{}),e.jsxs("div",{className:"text-sm px-6 text-center",children:[e.jsxs("span",{children:[o("By registering with Phaero, you agree to our")," "]}),e.jsx(N,{className:"text-sky-400",to:"/privacy-policy",children:o("Privacy Policy")}),e.jsxs("span",{children:[" ",o("and")," "]}),e.jsx(N,{className:"text-sky-400",to:"/terms-and-conditions",children:o("Terms and Conditions")}),e.jsx("span",{children:o("AGB zu")})]})]})}),e.jsx("div",{id:"overlay"})]})}export{F as default};
